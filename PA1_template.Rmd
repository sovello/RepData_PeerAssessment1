# Reproducible Research: Peer Assessment 1


## Loading and preprocessing the data
We first read the data into a variable
```{r, echo=TRUE}
activity <- read.csv("activity.csv", header=TRUE, na.strings="NA")

if( class(activity$date) != 'Date'){
  activity$date <- as.Date(activity$date)
}
#maintain the original data set
originalActivity <- activity
##transform the activity so that all NAs become 0s
activity[is.na(activity)] <- 0

#get the total steps for each day
dailySteps <- aggregate(activity$steps~activity$date, activity, sum)

#set the column names for our data
colnames(dailySteps) <- c("Date", "Total.Steps")
```

## What is mean total number of steps taken per day?
The histogram for total number of steps taken each day
```{r, echo=TRUE}
## Histogram
library(ggplot2)
#plot
qplot(Total.Steps, data=dailySteps, 
      ylab="Step Counts", xlab="Total Steps", binwidth=800)

#Mean per day
dailyMeanSteps <- round(mean(dailySteps$Total.Steps), digits=0)

#Median
dailyMedian <- round(median(dailySteps$Total.Steps), digits=0)
```

The mean number of steps per day is `r dailyMeanSteps` and the median is `r dailyMedian`.

## What is the average daily activity pattern?
```{r, echo=TRUE}
##aggregate steps per interval
averageIntervalSteps <- aggregate(activity$steps~activity$interval, activity, mean)
colnames(averageIntervalSteps) <- c("Interval", "AverageSteps")
##plot
qplot(Interval, AverageSteps, data = averageIntervalSteps, 
      xlab = "Interval", ylab="Average Steps", geom="line")

##return interval with maximum steps
intervalWithMaxSteps <- averageIntervalSteps[which.max(averageIntervalSteps$Average),1]
```

The `r intervalWithMaxSteps` interval is one with maximum average number of steps across all days

## Imputing missing values
```{r, echo=TRUE}
#we are going to use the non transformed dataset
# missing values in rows
completeRows <- complete.cases(originalActivity)
naRows <- sum(!completeRows)

#fill all rows with mean for the day
dailyMeanSteps <- aggregate(activity$steps~activity$date, activity, mean)

```
There are `r naRows` with missing values.

## Are there differences in activity patterns between weekdays and weekends?





